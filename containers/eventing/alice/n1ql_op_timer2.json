{
    "appcode": "function OnUpdate(doc, meta) {\n    var expiry = new Date();\n    expiry.setSeconds(expiry.getSeconds() + 300);\n    sleep(10);\n    var context = {docID : meta.id, random_text : \"e6cZZGHuh0R7Aumoe6cZZGHuh0R7Aumoe6cZZGHuh0R7Aumoe6cZZGHuh0R7Aumoe6cZZGHuh0R7Aumoe6cZZGHuh0R7Aumoe6cZZGHuh0R7Aumoe6cZZGHuh0R7Aumoe6cZZGHuh0R7Aumoe6cZZGHuh0R7Aumoe6cZZGHuh0R7Aumoe6cZZGHuh0R7Aumoe6cZZGHuh0R7Aumoe6cZZGHuh07Aumoe6cZZGHuh07Aumoe6cZZGHuh07Aumoe6\"};\n    createTimer(timerCallback,  expiry, meta.id, context);\n}\nfunction OnDelete(meta) {\n    var expiry = new Date();\n    expiry.setSeconds(expiry.getSeconds() + 300);\n    sleep(10);\n    var context = {docID : meta.id};\n    createTimer(NDtimerCallback,  expiry, meta.id, context);\n}\nfunction NDtimerCallback(context) {\n    var docID = context.docID;\n    sleep(10);\n    while (true) {\n    try {\n        var query = select result,AVG(rating),MIN(rating),MAX(rating) from `default` where result is not missing and rating >= 400 and rating <= 1000 group by result;\n        for( var row of query){ \n            var query1=select round(min(rating),2) as min_rating,round(max(rating),2) as max_rating,round(avg(rating),2) as avg_rating from `default` where result is not null and rating between 500 and 520;\n            for(var row1 of query1){ \n            var query = DELETE FROM `n1ql_op_timer_dst2` where meta().id = $docID;\n            }\n        }\n        break;\n    } catch (e) {\n        log(e);\n        }\n    }\n}\n\nfunction timerCallback(context) {\n    var docID = context.docID;\n    sleep(10);\n      while(true){    \n    try {\n        var query = select result,AVG(rating),MIN(rating),MAX(rating) from `default` where result is not missing and rating >= 400 and rating <= 1000 group by result;\n        for( var row of query){ \n            var query1=select round(min(rating),2) as min_rating,round(max(rating),2) as max_rating,round(avg(rating),2) as avg_rating from `default` where result is not null and rating between 500 and 520;\n            for(var row1 of query1){ \n            var value=row1;\n           Insert INTO `n1ql_op_timer_dst2` ( KEY, VALUE ) VALUES ( $docID , $value);\n         }\n        }\n        break;\n        }\n     catch (e) {\n        log(e);\n    }\n    }\n\n}\n\nfunction sleep(seconds) {\n  var start = new Date().getTime();\n  while(new Date().getTime() < start + seconds*1000){\n  }\n}",
    "depcfg": {
        "buckets": [],
        "metadata_bucket": "metadata",
        "source_bucket": "default"
    },
    "appname": "n1ql_op_timer2",
    "settings": {
          "dcp_stream_boundary": "everything",
          "deadline_timeout": 77,
          "execution_timeout": 75,
          "log_level": "INFO",
          "processing_status": false,
          "deployment_status": false
      }
}